---
title: "API Reference -> AI -> Task Breakdown"
description: "Use AI to break down complex tasks into manageable subtasks"
---

```mdx
---
title: 'AI Task Breakdown'
api: 'POST /ai/decompose-task'
description: 'Use AI to break down complex tasks into manageable subtasks'
---

Endpoint
```

POST /make-server-4010be06/ai/decompose-task

```

Decompose a large task into 3-5 smaller, manageable subtasks using AI (OpenAI GPT-4 or Anthropic Claude).

<Note>
Requires AI service configuration. Either `OPENAI_API_KEY` or `ANTHROPIC_API_KEY` must be set in Supabase secrets.
</Note>

---

Headers

<ParamField header="Authorization" type="string" required>
  Bearer token (uses public anon key)
  
```

Authorization: Bearer YOUR_ANON_KEY

````
</ParamField>

---

Request Body

<ParamField body="taskTitle" type="string" required>
The complex task to break down

Example: `"Complete science project"`
</ParamField>

<ParamField body="estimatedPoints" type="number" required>
Total points for the parent task

Example: `50`
</ParamField>

<ParamField body="context" type="string">
Optional additional context for better suggestions

Example: `"Break into steps for a 5th grader"`
</ParamField>

---

Response

<ResponseField name="subtasks" type="array">
Array of suggested subtasks

<Expandable title="subtask properties">
  <ResponseField name="title" type="string">
    Subtask description
  </ResponseField>
  
  <ResponseField name="points" type="number">
    Suggested points (sum equals `estimatedPoints`)
  </ResponseField>
  
  <ResponseField name="order" type="number">
    Suggested completion order (1, 2, 3, ...)
  </ResponseField>
</Expandable>
</ResponseField>

---

Example Request

```typescript
const response = await fetch('https://YOUR_PROJECT.supabase.co/functions/v1/make-server-4010be06/ai/decompose-task', {
method: 'POST',
headers: {
  'Authorization': `Bearer ${publicAnonKey}`,
  'Content-Type': 'application/json'
},
body: JSON.stringify({
  taskTitle: 'Complete science project',
  estimatedPoints: 50,
  context: 'Break this into manageable steps for a 5th grader'
})
})

const { subtasks } = await response.json()

// Show subtasks to user for approval
subtasks.forEach(subtask => {
console.log(`${subtask.order}. ${subtask.title} (${subtask.points} points)`)
})
````

---

Example Response

```json
{
  "subtasks": [
    {
      "title": "Research topic and gather sources",
      "points": 10,
      "order": 1
    },
    {
      "title": "Create project outline",
      "points": 8,
      "order": 2
    },
    {
      "title": "Build experiment or model",
      "points": 15,
      "order": 3
    },
    {
      "title": "Write final report",
      "points": 12,
      "order": 4
    },
    {
      "title": "Prepare presentation",
      "points": 5,
      "order": 5
    }
  ]
}
```

---

Error Responses

<ResponseExample>

```json 503 - AI Not Configured
{
  "error": "AI service not configured",
  "details": "Neither OpenAI nor Anthropic API key is set"
}
```


```json 400 - Missing Task Title
{
  "error": "Task title is required"
}
```


```json 500 - AI Service Error
{
  "error": "Failed to generate subtasks",
  "details": "OpenAI API error: Rate limit exceeded"
}
```

</ResponseExample>

---

AI Providers

OpenAI (GPT-4)

Used when: `OPENAI_API_KEY` is set

Model: `gpt-4-turbo-preview`

Benefits: High quality, detailed breakdowns Better context understanding More creative suggestions

Cost: ~\$0.03 per request

Anthropic (Claude 3)

Used when: Only `ANTHROPIC_API_KEY` is set

Model: `claude-3-sonnet-20240229`

Benefits: Fast responses Cost-effective Good quality

Cost: ~\$0.015 per request

---

Complete Workflow

```typescript
async function handleAIBreakdown(taskTitle: string, points: number) {
  try {
    setLoading(true)
    
    // 1. Call AI endpoint
    const response = await fetch('/ai/decompose-task', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${publicAnonKey}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        taskTitle,
        estimatedPoints: points,
        context: 'Break into 3-5 manageable steps'
      })
    })
    
    if (!response.ok) {
      throw new Error('AI service unavailable')
    }
    
    const { subtasks } = await response.json()
    
    // 2. Show subtasks to user for approval
    setSubtasks(subtasks)
    setShowReview(true)
    
    toast.success('Subtasks generated!')
    
  } catch (error) {
    console.error('AI breakdown failed:', error)
    
    // 3. Fall back to manual mode
    toast.error('AI unavailable. Create subtasks manually.')
    setManualMode(true)
    
  } finally {
    setLoading(false)
  }
}

// 4. User reviews and creates subtasks
async function createSubtasks(subtasks: Subtask[]) {
  for (const subtask of subtasks) {
    await createTask({
      title: subtask.title,
      points: subtask.points,
      category: parentTask.category,
      icon: parentTask.icon
    })
  }
  
  toast.success(`${subtasks.length} subtasks created!`)
  
  // Track usage
  trackIntercomEvent('task-breakdown-used', {
    originalTask: taskTitle,
    subtaskCount: subtasks.length
  })
}
```

---

Rate Limiting

<Warning>
  Implement rate limiting to prevent abuse and control costs:

  ```typescript
  // Limit to 10 AI requests per user per day
  const requestCount = await kv.get(`ai-requests:${userId}:${today}`) || 0
  
  if (requestCount >= 10) {
    return c.json({ 
      error: 'Daily AI limit reached',
      details: 'You can make 10 AI breakdowns per day'
    }, 429)
  }
  
  await kv.set(`ai-requests:${userId}:${today}`, requestCount + 1)
  ```
</Warning>

---

Best Practices

<AccordionGroup>
  <Accordion title="Provide Context" icon="message">
    Better results with specific context:

    ```javascript
    // ❌ Generic
    context: 'Break this down'
    
    // ✅ Specific
    context: 'Break into steps for a 10-year-old, focus on homework completion'
    ```
  </Accordion>
  <Accordion title="Set Appropriate Points" icon="coins">
    Realistic point totals: Simple tasks: 5-10 points Medium tasks: 15-30 points Complex tasks: 40-100 points
  </Accordion>
  <Accordion title="Review AI Suggestions" icon="magnifying-glass">
    Always let users review before creating: AI might misunderstand context Users may want to edit titles Point distribution may need adjustment
  </Accordion>
  <Accordion title="Provide Manual Fallback" icon="hand">
    Always offer manual mode: AI service might be unavailable User might prefer manual control Builds confidence in the feature
  </Accordion>
</AccordionGroup>

---

Cost Management

Average Costs: 1000 breakdowns/month (OpenAI): ~$30
1000 breakdowns/month (Anthropic): ~$15

Tips: Implement per-user rate limits Cache common breakdowns Use Anthropic for cost savings Monitor usage via logs

---

Notes

<Info>
  AI service is optional. Task Dojo works fully without it; users can always create subtasks manually.
</Info>

<Tip>
  Track AI usage via Intercom events to understand feature adoption and justify costs.
</Tip>

---

Next Steps

<CardGroup cols={2}>
  <Card title="AI Setup" icon="brain" href="/technical/integrations/ai-services">
    Configure OpenAI/Anthropic
  </Card>
  <Card title="Create Task" icon="plus" href="/api-reference/tasks/create-task">
    Create subtasks
  </Card>
  <Card title="Task Breakdown Guide" icon="list-tree" href="/user-guide/feats/feat-breakdown">
    User guide
  </Card>
</CardGroup>